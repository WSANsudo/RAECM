{
  "prompts": [
    {
      "id": "default",
      "name": "默认提示词",
      "description": "程序内置的默认提示词",
      "system_prompt": "",
      "cost_info": {
        "char_count": 1149,
        "token_count": 368,
        "record_count": 13502,
        "avg_input_tokens": 331.8,
        "avg_output_tokens": 146.4,
        "total_cost": {
          "deepseek-v3.2": 10.9203,
          "gemini-2.5-flash-lite-preview-06-17": 5.6164,
          "gpt-5-nano-ca": 4.3892,
          "gemini-2.5-flash": 31.3495,
          "grok-4-fast": 8.8612,
          "gpt-4.1-nano": 9.8287,
          "gpt-4o-mini": 14.743,
          "gpt-4o-mini-ca": 10.5307,
          "gpt-5-mini": 38.4057,
          "claude-3-5-haiku-20241022": 80.0862,
          "qwen3-235b-a22b": 19.6573,
          "kimi-k2-0711-preview": 39.3146,
          "gpt-4o": 245.7165,
          "gpt-5": 192.0283,
          "gemini-2.5-pro": 122.0021,
          "claude-3-5-sonnet-20241022": 240.2585,
          "grok-4": 192.2068,
          "deepseek-r1": 33.6983
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.8088,
          "gemini-2.5-flash-lite-preview-06-17": 0.416,
          "gpt-5-nano-ca": 0.3251,
          "gemini-2.5-flash": 2.3218,
          "grok-4-fast": 0.6563,
          "gpt-4.1-nano": 0.7279,
          "gpt-4o-mini": 1.0919,
          "gpt-4o-mini-ca": 0.7799,
          "gpt-5-mini": 2.8444,
          "claude-3-5-haiku-20241022": 5.9314,
          "qwen3-235b-a22b": 1.4559,
          "kimi-k2-0711-preview": 2.9118,
          "gpt-4o": 18.1985,
          "gpt-5": 14.2222,
          "gemini-2.5-pro": 9.0359,
          "claude-3-5-sonnet-20241022": 17.7943,
          "grok-4": 14.2354,
          "deepseek-r1": 2.4958
        },
        "note": "程序内置默认提示词"
      }
    },
    {
      "id": "p1",
      "name": "精简版-强调推理",
      "description": "精简提示词，强调基于证据推理可能的型号，约480字符",
      "system_prompt": "Identify device vendor/model/OS/firmware from network scan data.\n\nReturn ONLY JSON array: [{\"ip\": str, \"vendor\": str|null, \"model\": [[name,conf],...], \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\nRULES:\n- INFER model from banners/services when not explicit (e.g., \"MikroTik\" banner → RouterOS device)\n- model: hardware SKU only, use [[name, confidence], ...] for candidates\n- os/firmware: include version (e.g., \"RouterOS 6.49.10\")\n- result_type: \"direct\" if explicit, \"inferred\" if deduced\n- Use null for unknown, never \"unknown\"",
      "cost_info": {
        "char_count": 658,
        "token_count": 208,
        "record_count": 13502,
        "avg_input_tokens": 331.8,
        "avg_output_tokens": 146.4,
        "total_cost": {
          "deepseek-v3.2": 10.0561,
          "gemini-2.5-flash-lite-preview-06-17": 5.3283,
          "gpt-5-nano-ca": 4.2452,
          "gemini-2.5-flash": 30.9174,
          "grok-4-fast": 8.2851,
          "gpt-4.1-nano": 9.3245,
          "gpt-4o-mini": 13.9868,
          "gpt-4o-mini-ca": 9.9906,
          "gpt-5-mini": 37.1454,
          "claude-3-5-haiku-20241022": 76.4854,
          "qwen3-235b-a22b": 18.6491,
          "kimi-k2-0711-preview": 37.2982,
          "gpt-4o": 233.1137,
          "gpt-5": 185.7269,
          "gemini-2.5-pro": 116.9609,
          "claude-3-5-sonnet-20241022": 229.4561,
          "grok-4": 183.5648,
          "deepseek-r1": 31.9699
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.7448,
          "gemini-2.5-flash-lite-preview-06-17": 0.3946,
          "gpt-5-nano-ca": 0.3144,
          "gemini-2.5-flash": 2.2898,
          "grok-4-fast": 0.6136,
          "gpt-4.1-nano": 0.6906,
          "gpt-4o-mini": 1.0359,
          "gpt-4o-mini-ca": 0.7399,
          "gpt-5-mini": 2.7511,
          "claude-3-5-haiku-20241022": 5.6647,
          "qwen3-235b-a22b": 1.3812,
          "kimi-k2-0711-preview": 2.7624,
          "gpt-4o": 17.2651,
          "gpt-5": 13.7555,
          "gemini-2.5-pro": 8.6625,
          "claude-3-5-sonnet-20241022": 16.9942,
          "grok-4": 13.5954,
          "deepseek-r1": 2.3678
        }
      }
    },
    {
      "id": "p2",
      "name": "详细版-多候选推理",
      "description": "详细提示词，要求列出多个可能的型号候选，约920字符",
      "system_prompt": "Analyze network scan records to identify device vendor, model, OS and firmware.\n\nCRITICAL: Return ONLY valid JSON array. No markdown, no explanation.\nFormat: [{\"ip\": str, \"vendor\": str|null, \"model\": [[str,float],...]|null, \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]|null}]\n\n=== INFERENCE RULES ===\n- When model is NOT explicitly stated, INFER from:\n  1. Banner signatures (e.g., \"MikroTik\" → MikroTik router series)\n  2. Service fingerprints (e.g., specific HTTP headers)\n  3. Protocol behaviors (e.g., SSH version strings)\n  4. Port combinations (e.g., 8291+8728 → MikroTik)\n- List TOP 3 most likely models with confidence scores\n- result_type=\"inferred\" when deduced, \"direct\" when explicit\n\n=== FIELD RULES ===\n- vendor: Manufacturer name\n- model: [[\"model_name\", confidence], ...] sorted by confidence\n- os: Include version (e.g., \"RouterOS 6.49.10\")\n- firmware: Full name with version\n- type: router|switch|server|firewall|camera|nas|printer|iot|appliance\n- Use null for unknown fields",
      "cost_info": {
        "char_count": 1118,
        "token_count": 334,
        "record_count": 13502,
        "avg_input_tokens": 331.8,
        "avg_output_tokens": 146.4,
        "total_cost": {
          "deepseek-v3.2": 10.7366,
          "gemini-2.5-flash-lite-preview-06-17": 5.5552,
          "gpt-5-nano-ca": 4.3586,
          "gemini-2.5-flash": 31.2577,
          "grok-4-fast": 8.7388,
          "gpt-4.1-nano": 9.7215,
          "gpt-4o-mini": 14.5823,
          "gpt-4o-mini-ca": 10.4159,
          "gpt-5-mini": 38.1379,
          "claude-3-5-haiku-20241022": 79.321,
          "qwen3-235b-a22b": 19.4431,
          "kimi-k2-0711-preview": 38.8861,
          "gpt-4o": 243.0384,
          "gpt-5": 190.6893,
          "gemini-2.5-pro": 120.9308,
          "claude-3-5-sonnet-20241022": 237.9629,
          "grok-4": 190.3704,
          "deepseek-r1": 33.331
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.7952,
          "gemini-2.5-flash-lite-preview-06-17": 0.4114,
          "gpt-5-nano-ca": 0.3228,
          "gemini-2.5-flash": 2.315,
          "grok-4-fast": 0.6472,
          "gpt-4.1-nano": 0.72,
          "gpt-4o-mini": 1.08,
          "gpt-4o-mini-ca": 0.7714,
          "gpt-5-mini": 2.8246,
          "claude-3-5-haiku-20241022": 5.8748,
          "qwen3-235b-a22b": 1.44,
          "kimi-k2-0711-preview": 2.88,
          "gpt-4o": 18.0002,
          "gpt-5": 14.123,
          "gemini-2.5-pro": 8.9565,
          "claude-3-5-sonnet-20241022": 17.6243,
          "grok-4": 14.0994,
          "deepseek-r1": 2.4686
        }
      }
    },
    {
      "id": "p3",
      "name": "知识增强版",
      "description": "包含常见设备特征知识的提示词，约1050字符",
      "system_prompt": "Identify network device vendor/model/OS/firmware using scan data and domain knowledge.\n\nReturn JSON array: [{\"ip\": str, \"vendor\": str|null, \"model\": [[name,conf],...], \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\", \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\n=== KNOWN SIGNATURES ===\n- MikroTik: ports 8291/8728/8729, \"MikroTik\" in banners, RouterOS\n- Cisco: \"cisco\" in banners, IOS/IOS-XE, ports 22/23/443\n- Ubiquiti: \"UBNT\"/\"UniFi\" in banners, EdgeOS/UniFi OS\n- Juniper: \"JUNOS\" in banners, Junos OS\n- Fortinet: \"FortiGate\" in banners, FortiOS\n- TP-Link: \"TP-LINK\" in banners, various consumer models\n- Huawei: \"Huawei\"/\"VRP\" in banners, VRP OS\n\n=== INFERENCE ===\n- Match signatures → infer vendor/model candidates\n- No match → analyze service patterns\n- List up to 3 candidates with confidence\n- result_type: \"direct\" if explicit, \"inferred\" if deduced\n- Use null for truly unknown fields",
      "cost_info": {
        "char_count": 968,
        "token_count": 319,
        "record_count": 13502,
        "avg_input_tokens": 331.8,
        "avg_output_tokens": 146.4,
        "total_cost": {
          "deepseek-v3.2": 10.6556,
          "gemini-2.5-flash-lite-preview-06-17": 5.5282,
          "gpt-5-nano-ca": 4.3451,
          "gemini-2.5-flash": 31.2172,
          "grok-4-fast": 8.6848,
          "gpt-4.1-nano": 9.6743,
          "gpt-4o-mini": 14.5114,
          "gpt-4o-mini-ca": 10.3653,
          "gpt-5-mini": 38.0197,
          "claude-3-5-haiku-20241022": 78.9834,
          "qwen3-235b-a22b": 19.3486,
          "kimi-k2-0711-preview": 38.6971,
          "gpt-4o": 241.8569,
          "gpt-5": 190.0985,
          "gemini-2.5-pro": 120.4582,
          "claude-3-5-sonnet-20241022": 236.9502,
          "grok-4": 189.5602,
          "deepseek-r1": 33.1689
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.7892,
          "gemini-2.5-flash-lite-preview-06-17": 0.4094,
          "gpt-5-nano-ca": 0.3218,
          "gemini-2.5-flash": 2.312,
          "grok-4-fast": 0.6432,
          "gpt-4.1-nano": 0.7165,
          "gpt-4o-mini": 1.0748,
          "gpt-4o-mini-ca": 0.7677,
          "gpt-5-mini": 2.8159,
          "claude-3-5-haiku-20241022": 5.8498,
          "qwen3-235b-a22b": 1.433,
          "kimi-k2-0711-preview": 2.866,
          "gpt-4o": 17.9127,
          "gpt-5": 14.0793,
          "gemini-2.5-pro": 8.9215,
          "claude-3-5-sonnet-20241022": 17.5493,
          "grok-4": 14.0394,
          "deepseek-r1": 2.4566
        }
      }
    },
    {
      "id": "p4",
      "name": "结构约束+负面示例版",
      "description": "方案三+方案五组合：严格字段定义+常见错误约束，推荐使用",
      "system_prompt": "Identify device vendor/model/OS/firmware from network scan data.\n\nReturn ONLY JSON array: [{\"ip\": str, \"vendor\": str|null, \"model\": [[name,conf],...]|null, \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\n=== STRICT FIELD DEFINITIONS ===\nvendor: Manufacturer name ONLY (e.g., \"MikroTik\", \"Cisco\", \"Juniper\")\nmodel: Hardware SKU ONLY as [[name, confidence], ...] (e.g., [[\"RB5009\", 0.9]], [[\"MX480\", 0.8]])\nos: Operating system WITH version (e.g., \"RouterOS 6.49.15\", \"JunOS 21.4R1\")\nfirmware: Full firmware identifier with version (e.g., \"MikroTik 6.49.15\")\ntype: \"router\"|\"switch\"|\"firewall\"|\"server\"|\"camera\"|\"nas\"|\"printer\"|\"iot\"|\"appliance\"|null\nresult_type: \"direct\" if explicit in banner, \"inferred\" if deduced\nconfidence: 0.9+ for explicit match, 0.7-0.9 for strong inference, 0.5-0.7 for weak inference\n\n=== COMMON MISTAKES TO AVOID ===\n❌ model: \"RouterOS\" → WRONG (RouterOS is OS, not model)\n❌ model: \"MikroTik 6.49.15\" → WRONG (this is firmware)\n❌ model: [[\"MikroTik\", 0.9]] → WRONG (MikroTik is vendor, not model)\n❌ os: \"RouterOS\" without version → WRONG (must include version)\n❌ confidence: 0.95 with single weak evidence → WRONG (must match evidence quality)\n✓ Use null for model if only vendor/OS is identifiable\n✓ Include version in os field when available",
      "cost_info": {
        "char_count": 1395,
        "token_count": 458,
        "note": "方案三+方案五组合，需运行 --calculate-cost 获取完整费用估算"
      }
    }
  ]
}