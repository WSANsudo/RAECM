{
  "prompts": [
    {
      "id": "default",
      "name": "默认提示词",
      "description": "程序内置的默认提示词，不在此文件中定义",
      "system_prompt": null,
      "cost_info": {
        "char_count": 1433,
        "token_count": 438,
        "record_count": 13502,
        "avg_input_tokens": 335.3,
        "avg_output_tokens": 138.6,
        "total_cost": {
          "deepseek-v3.2": 11.1665,
          "gemini-2.5-flash-lite-preview-06-17": 5.5937,
          "gpt-5-nano-ca": 4.294,
          "gemini-2.5-flash": 30.1,
          "grok-4-fast": 8.9415,
          "gpt-4.1-nano": 9.7889,
          "gpt-4o-mini": 14.6834,
          "gpt-4o-mini-ca": 10.4881,
          "gpt-5-mini": 37.5729,
          "claude-3-5-haiku-20241022": 79.2784,
          "qwen3-235b-a22b": 19.5778,
          "kimi-k2-0711-preview": 39.1557,
          "gpt-4o": 244.7229,
          "gpt-5": 187.8644,
          "gemini-2.5-pro": 120.3473,
          "claude-3-5-sonnet-20241022": 237.8352,
          "grok-4": 190.2682,
          "deepseek-r1": 33.562
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.827,
          "gemini-2.5-flash-lite-preview-06-17": 0.4143,
          "gpt-5-nano-ca": 0.318,
          "gemini-2.5-flash": 2.2293,
          "grok-4-fast": 0.6622,
          "gpt-4.1-nano": 0.725,
          "gpt-4o-mini": 1.0875,
          "gpt-4o-mini-ca": 0.7768,
          "gpt-5-mini": 2.7828,
          "claude-3-5-haiku-20241022": 5.8716,
          "qwen3-235b-a22b": 1.45,
          "kimi-k2-0711-preview": 2.9,
          "gpt-4o": 18.1249,
          "gpt-5": 13.9138,
          "gemini-2.5-pro": 8.9133,
          "claude-3-5-sonnet-20241022": 17.6148,
          "grok-4": 14.0918,
          "deepseek-r1": 2.4857
        },
        "note": "程序内置默认提示词"
      }
    },
    {
      "id": "p1",
      "name": "精简版-强调推理",
      "description": "精简提示词，强调基于证据推理可能的型号，约480字符",
      "system_prompt": "Identify device vendor/model/OS/firmware from network scan data.\n\n⚠️ CRITICAL: Return ONLY valid JSON array. Each result MUST contain the EXACT \"ip\" from input - DO NOT modify or omit any IP. Return exactly the same number of results as input records.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"vendor\": str|null, \"model\": [[name,conf],...], \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\nRULES:\n- IP addresses must be copied EXACTLY as provided\n- INFER model from banners/services when not explicit (e.g., \"MikroTik\" banner → RouterOS device)\n- model: hardware SKU only, use [[name, confidence], ...] for candidates\n- os/firmware: include version (e.g., \"RouterOS 6.49.10\")\n- result_type: \"direct\" if explicit, \"inferred\" if deduced\n- Use null for unknown, never \"unknown\"",
      "cost_info": {
        "char_count": 658,
        "token_count": 208,
        "record_count": 13502,
        "avg_input_tokens": 335.3,
        "avg_output_tokens": 138.6,
        "total_cost": {
          "deepseek-v3.2": 9.9242,
          "gemini-2.5-flash-lite-preview-06-17": 5.1796,
          "gpt-5-nano-ca": 4.087,
          "gemini-2.5-flash": 29.4789,
          "grok-4-fast": 8.1133,
          "gpt-4.1-nano": 9.0643,
          "gpt-4o-mini": 13.5964,
          "gpt-4o-mini-ca": 9.7117,
          "gpt-5-mini": 35.7612,
          "claude-3-5-haiku-20241022": 74.1022,
          "qwen3-235b-a22b": 18.1285,
          "kimi-k2-0711-preview": 36.257,
          "gpt-4o": 226.6064,
          "gpt-5": 178.8061,
          "gemini-2.5-pro": 113.1007,
          "claude-3-5-sonnet-20241022": 222.3067,
          "grok-4": 177.8454,
          "deepseek-r1": 31.0774
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.735,
          "gemini-2.5-flash-lite-preview-06-17": 0.3836,
          "gpt-5-nano-ca": 0.3027,
          "gemini-2.5-flash": 2.1833,
          "grok-4-fast": 0.6009,
          "gpt-4.1-nano": 0.6713,
          "gpt-4o-mini": 1.007,
          "gpt-4o-mini-ca": 0.7193,
          "gpt-5-mini": 2.6486,
          "claude-3-5-haiku-20241022": 5.4882,
          "qwen3-235b-a22b": 1.3427,
          "kimi-k2-0711-preview": 2.6853,
          "gpt-4o": 16.7832,
          "gpt-5": 13.2429,
          "gemini-2.5-pro": 8.3766,
          "claude-3-5-sonnet-20241022": 16.4647,
          "grok-4": 13.1718,
          "deepseek-r1": 2.3017
        }
      }
    },
    {
      "id": "p2",
      "name": "详细版-多候选推理",
      "description": "详细提示词，要求列出多个可能的型号候选，约920字符",
      "system_prompt": "Analyze network scan records to identify device vendor, model, OS and firmware.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain the EXACT \"ip\" from input - DO NOT modify, truncate, or omit any IP.\n3. Return exactly the same number of results as input records.\n4. IP addresses must be copied EXACTLY as provided.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"vendor\": str|null, \"model\": [[str,float],...]|null, \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]|null}]\n\n=== INFERENCE RULES ===\n- When model is NOT explicitly stated, INFER from:\n  1. Banner signatures (e.g., \"MikroTik\" → MikroTik router series)\n  2. Service fingerprints (e.g., specific HTTP headers)\n  3. Protocol behaviors (e.g., SSH version strings)\n  4. Port combinations (e.g., 8291+8728 → MikroTik)\n- List TOP 3 most likely models with confidence scores\n- result_type=\"inferred\" when deduced, \"direct\" when explicit\n\n=== FIELD RULES ===\n- vendor: Manufacturer name\n- model: [[\"model_name\", confidence], ...] sorted by confidence\n- os: Include version (e.g., \"RouterOS 6.49.10\")\n- firmware: Full name with version\n- type: router|switch|server|firewall|camera|nas|printer|iot|appliance\n- Use null for unknown fields",
      "cost_info": {
        "char_count": 1118,
        "token_count": 334,
        "record_count": 13502,
        "avg_input_tokens": 335.3,
        "avg_output_tokens": 138.6,
        "total_cost": {
          "deepseek-v3.2": 10.6047,
          "gemini-2.5-flash-lite-preview-06-17": 5.4064,
          "gpt-5-nano-ca": 4.2004,
          "gemini-2.5-flash": 29.8192,
          "grok-4-fast": 8.567,
          "gpt-4.1-nano": 9.4612,
          "gpt-4o-mini": 14.1919,
          "gpt-4o-mini-ca": 10.137,
          "gpt-5-mini": 36.7537,
          "claude-3-5-haiku-20241022": 76.9379,
          "qwen3-235b-a22b": 18.9225,
          "kimi-k2-0711-preview": 37.845,
          "gpt-4o": 236.5311,
          "gpt-5": 183.7685,
          "gemini-2.5-pro": 117.0706,
          "claude-3-5-sonnet-20241022": 230.8136,
          "grok-4": 184.6509,
          "deepseek-r1": 32.4386
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.7854,
          "gemini-2.5-flash-lite-preview-06-17": 0.4004,
          "gpt-5-nano-ca": 0.3111,
          "gemini-2.5-flash": 2.2085,
          "grok-4-fast": 0.6345,
          "gpt-4.1-nano": 0.7007,
          "gpt-4o-mini": 1.0511,
          "gpt-4o-mini-ca": 0.7508,
          "gpt-5-mini": 2.7221,
          "claude-3-5-haiku-20241022": 5.6983,
          "qwen3-235b-a22b": 1.4015,
          "kimi-k2-0711-preview": 2.8029,
          "gpt-4o": 17.5182,
          "gpt-5": 13.6105,
          "gemini-2.5-pro": 8.6706,
          "claude-3-5-sonnet-20241022": 17.0948,
          "grok-4": 13.6758,
          "deepseek-r1": 2.4025
        }
      }
    },
    {
      "id": "p3",
      "name": "知识增强版",
      "description": "包含常见设备特征知识的提示词，约1050字符",
      "system_prompt": "Identify network device vendor/model/OS/firmware using scan data and domain knowledge.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain the EXACT \"ip\" from input - DO NOT modify or omit any IP.\n3. Return exactly the same number of results as input records.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"vendor\": str|null, \"model\": [[name,conf],...], \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\", \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\n=== KNOWN SIGNATURES ===\n- MikroTik: ports 8291/8728/8729, \"MikroTik\" in banners, RouterOS\n- Cisco: \"cisco\" in banners, IOS/IOS-XE, ports 22/23/443\n- Ubiquiti: \"UBNT\"/\"UniFi\" in banners, EdgeOS/UniFi OS\n- Juniper: \"JUNOS\" in banners, Junos OS; \"Version 6.00LS\" in FTP banner → highly probably Juniper/JUNOS\n- Fortinet: \"FortiGate\" in banners, FortiOS\n- TP-Link: \"TP-LINK\" in banners, various consumer models\n- Huawei: \"Huawei\"/\"VRP\" in banners, VRP OS\n\n=== INFERENCE ===\n- Match signatures → infer vendor/model candidates\n- No match → analyze service patterns\n- List up to 3 candidates with confidence\n- result_type: \"direct\" if explicit, \"inferred\" if deduced\n- Use null for truly unknown fields",
      "cost_info": {
        "char_count": 968,
        "token_count": 319,
        "record_count": 13502,
        "avg_input_tokens": 335.3,
        "avg_output_tokens": 138.6,
        "total_cost": {
          "deepseek-v3.2": 10.5237,
          "gemini-2.5-flash-lite-preview-06-17": 5.3794,
          "gpt-5-nano-ca": 4.1869,
          "gemini-2.5-flash": 29.7787,
          "grok-4-fast": 8.513,
          "gpt-4.1-nano": 9.414,
          "gpt-4o-mini": 14.121,
          "gpt-4o-mini-ca": 10.0864,
          "gpt-5-mini": 36.6355,
          "claude-3-5-haiku-20241022": 76.6003,
          "qwen3-235b-a22b": 18.828,
          "kimi-k2-0711-preview": 37.6559,
          "gpt-4o": 235.3496,
          "gpt-5": 183.1777,
          "gemini-2.5-pro": 116.598,
          "claude-3-5-sonnet-20241022": 229.8009,
          "grok-4": 183.8407,
          "deepseek-r1": 32.2765
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.7794,
          "gemini-2.5-flash-lite-preview-06-17": 0.3984,
          "gpt-5-nano-ca": 0.3101,
          "gemini-2.5-flash": 2.2055,
          "grok-4-fast": 0.6305,
          "gpt-4.1-nano": 0.6972,
          "gpt-4o-mini": 1.0458,
          "gpt-4o-mini-ca": 0.747,
          "gpt-5-mini": 2.7133,
          "claude-3-5-haiku-20241022": 5.6733,
          "qwen3-235b-a22b": 1.3945,
          "kimi-k2-0711-preview": 2.7889,
          "gpt-4o": 17.4307,
          "gpt-5": 13.5667,
          "gemini-2.5-pro": 8.6356,
          "claude-3-5-sonnet-20241022": 17.0198,
          "grok-4": 13.6158,
          "deepseek-r1": 2.3905
        }
      }
    },
    {
      "id": "p4",
      "name": "结构约束+负面示例版",
      "description": "方案三+方案五组合：严格字段定义+常见错误约束，推荐使用",
      "system_prompt": "Identify device vendor/model/OS/firmware from network scan data.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY a valid JSON array. NO markdown code blocks, NO explanations, NO extra text.\n2. Each result MUST contain the EXACT \"ip\" field from input - DO NOT modify, truncate, or omit any IP address.\n3. The number of results MUST equal the number of input records.\n4. IP addresses must be copied EXACTLY as provided.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"vendor\": str|null, \"model\": [[name,conf],...]|null, \"os\": str|null, \"firmware\": str|null, \"type\": str|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\n=== STRICT FIELD DEFINITIONS ===\nvendor: Manufacturer name ONLY (e.g., \"MikroTik\", \"Cisco\", \"Juniper\")\nmodel: Hardware SKU ONLY as [[name, confidence], ...] (e.g., [[\"RB5009\", 0.9]], [[\"MX480\", 0.8]])\nos: Operating system WITH version (e.g., \"RouterOS 6.49.15\", \"JunOS 21.4R1\")\nfirmware: Full firmware identifier with version (e.g., \"MikroTik 6.49.15\")\ntype: MUST be one of: \"router\"|\"switch\"|\"firewall\"|\"server\"|\"camera\"|\"nas\"|\"printer\"|\"iot\"|\"appliance\"|null\nresult_type: \"direct\" if explicit in banner, \"inferred\" if deduced\nconfidence: 0.9+ for explicit match, 0.7-0.9 for strong inference, 0.5-0.7 for weak inference\n\n=== DEVICE TYPE STANDARDIZATION ===\n⚠️ Use ONLY standard device types. Map ambiguous types to standard ones:\n- management_interface → router\n- management → router\n- web_interface → server\n- network_device → router (if routing features) or switch\n- gateway → router\n- access_point/ap/wap → router\n- broadband_router → router\n\n=== COMMON MISTAKES TO AVOID ===\n❌ model: \"RouterOS\" → WRONG (RouterOS is OS, not model)\n❌ model: \"MikroTik 6.49.15\" → WRONG (this is firmware)\n❌ model: [[\"MikroTik\", 0.9]] → WRONG (MikroTik is vendor, not model)\n❌ os: \"RouterOS\" without version → WRONG (must include version)\n❌ type: \"management_interface\" → WRONG (use \"router\" instead)\n❌ type: \"management\" → WRONG (use \"router\" instead)\n❌ confidence: 0.95 with single weak evidence → WRONG (must match evidence quality)\n✓ Use null for model if only vendor/OS is identifiable\n✓ Include version in os field when available",
      "cost_info": {
        "char_count": 1395,
        "token_count": 465,
        "record_count": 13502,
        "avg_input_tokens": 335.3,
        "avg_output_tokens": 138.6,
        "total_cost": {
          "deepseek-v3.2": 11.3123,
          "gemini-2.5-flash-lite-preview-06-17": 5.6423,
          "gpt-5-nano-ca": 4.3183,
          "gemini-2.5-flash": 30.173,
          "grok-4-fast": 9.0387,
          "gpt-4.1-nano": 9.874,
          "gpt-4o-mini": 14.811,
          "gpt-4o-mini-ca": 10.5793,
          "gpt-5-mini": 37.7856,
          "claude-3-5-haiku-20241022": 79.886,
          "qwen3-235b-a22b": 19.748,
          "kimi-k2-0711-preview": 39.4959,
          "gpt-4o": 246.8497,
          "gpt-5": 188.9278,
          "gemini-2.5-pro": 121.198,
          "claude-3-5-sonnet-20241022": 239.6581,
          "grok-4": 191.7265,
          "deepseek-r1": 33.8537
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.8378,
          "gemini-2.5-flash-lite-preview-06-17": 0.4179,
          "gpt-5-nano-ca": 0.3198,
          "gemini-2.5-flash": 2.2347,
          "grok-4-fast": 0.6694,
          "gpt-4.1-nano": 0.7313,
          "gpt-4o-mini": 1.0969,
          "gpt-4o-mini-ca": 0.7835,
          "gpt-5-mini": 2.7985,
          "claude-3-5-haiku-20241022": 5.9166,
          "qwen3-235b-a22b": 1.4626,
          "kimi-k2-0711-preview": 2.9252,
          "gpt-4o": 18.2825,
          "gpt-5": 13.9926,
          "gemini-2.5-pro": 8.9763,
          "claude-3-5-sonnet-20241022": 17.7498,
          "grok-4": 14.1999,
          "deepseek-r1": 2.5073
        }
      }
    },
    {
      "id": "p5",
      "name": "知识增强+多候选输出版",
      "description": "包含厂商-OS映射知识，支持输出多个候选类型/OS（带置信度），推荐使用",
      "system_prompt": "Identify device vendor/model/OS/firmware from network scan data.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY a valid JSON array. NO markdown code blocks, NO explanations, NO extra text.\n2. Each result MUST contain the EXACT \"ip\" field from input - DO NOT modify, truncate, or omit any IP address.\n3. The number of results MUST equal the number of input records.\n4. IP addresses must be copied EXACTLY as provided.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"vendor\": str|null, \"model\": [[name,conf],...]|null, \"os\": [[name,conf],...]|null, \"firmware\": str|null, \"type\": [[name,conf],...]|null, \"result_type\": \"direct\"|\"inferred\"|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str, \"weight\": 0-1}]}]\n\n=== MULTI-CANDIDATE OUTPUT ===\nFor type and os fields, output multiple candidates with confidence scores:\n- Format: [[\"candidate1\", 0.9], [\"candidate2\", 0.7], ...]\n- Only include candidates with confidence >= 0.6\n- Sort by confidence descending\n- Example type: [[\"router\", 0.9], [\"firewall\", 0.7]]\n- Example os: [[\"RouterOS 6.49.10\", 0.95], [\"Linux\", 0.65]]\n\n=== VENDOR-OS KNOWLEDGE ===\n- MikroTik → RouterOS (e.g., \"RouterOS 6.49.10\")\n- NEC → UNIVERGE IX / IX Series Software (e.g., \"IX Series 10.9.22\")\n- Zyxel → ZyNOS / ZLD / ZyWALL OS\n- Allied Telesis → AlliedWare / AlliedWare Plus\n- Cisco → IOS / IOS-XE / IOS-XR / NX-OS\n- Juniper → JunOS\n- Fortinet → FortiOS\n- Ubiquiti → EdgeOS / UniFi OS / AirOS\n- Keenetic → KeeneticOS\n\n=== FIELD RULES ===\nvendor: Manufacturer name only\nmodel: Hardware SKU as [[name, conf], ...], null if unknown\nos: [[os_name_with_version, conf], ...] - multiple candidates allowed\ntype: [[type_name, conf], ...] - router|switch|firewall|server|ap|camera|nas|printer|iot|appliance\nconfidence: Overall confidence (0.9+ explicit, 0.7-0.9 strong, 0.5-0.7 weak)\n\n=== AVOID ===\n❌ model: \"RouterOS\" (this is OS)\n❌ os/type candidates with confidence < 0.6\n❌ os without version when version is available",
      "cost_info": {
        "char_count": 1750,
        "token_count": 550,
        "note": "知识增强版，支持多候选输出"
      }
    },
    {
      "id": "vendor",
      "name": "Vendor专属识别版(RAG)",
      "description": "专门针对厂商(Vendor)识别任务优化，包含知识增强，只输出vendor字段",
      "system_prompt": "Identify device VENDOR (manufacturer) from network scan data.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"vendor\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== HIGH CONFIDENCE SIGNATURES (极大概率) ===\n- SSH-*-Cisco-* → Cisco\n- cisco-IOS (HTTP) → Cisco\n- User Access Verification (Telnet) → Cisco\n- SSH-2.0-ROSSSH → MikroTik\n- MikroTik, RouterOS → MikroTik\n- SSH-2.0-HUAWEI-* → Huawei\n- Stelnet warning, VRP → Huawei\n- 220 FTP service ready. → Huawei\n- HTTPD (HTTP Server) → H3C\n- SSH-*-Comware-* → H3C\n- SSH-*-RGOS_* → Ruijie\n- Version 6.00LS (FTP) → Juniper\n- SSH-2.0-OpenSSH_7.5 → Juniper\n- SSH-2.0-OpenSSH_6.9 → Juniper\n- Embedthis-Appweb/3.2.3 → Juniper\n- JUNOS → Juniper\n- FortiGate, FortiOS → Fortinet\n- UBNT, UniFi, EdgeOS → Ubiquiti\n- ZyXEL, ZyNOS → ZyXEL\n- UNIVERGE, IX Series → NEC\n- Yamaha, RTX → Yamaha\n- Server: uc-httpd → Xiongmai\n- Server: H264DVR → H264DVR\n- TVT RTSP Server, Cross Web Server, DVR Components Download → TVT\n- Hello, this is Quagga → Quagga\n- Server: kong/ → Opensource (Kong API Gateway)\n\n=== MEDIUM CONFIDENCE (需结合其他证据) ===\n- nginx (HTTP) → Cisco (combine with other evidence)\n- SSH-*-OpenSSH_*p1 Debian-* → Linux/net-snmp (combine with other evidence)\n\n=== NORMALIZE VENDOR NAMES ===\n- Juniper Networks, Inc. → Juniper\n- ciscoSystems → Cisco\n- HUAWEI Technology → Huawei\n\n=== RULES ===\n- vendor = manufacturer name, NOT OS name\n- RouterOS is OS → vendor is MikroTik\n- JunOS is OS → vendor is Juniper\n- Use null if confidence < 0.5",
      "cost_info": {
        "char_count": 1150,
        "token_count": 400,
        "note": "Vendor专属识别提示词-RAG版"
      }
    },
    {
      "id": "vendor_norag",
      "name": "Vendor专属识别版(noRAG)",
      "description": "专门针对厂商(Vendor)识别任务优化，不包含知识增强，只输出vendor字段",
      "system_prompt": "Identify device VENDOR (manufacturer) from network scan data.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"vendor\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== RULES ===\n- vendor = manufacturer name, NOT OS name\n- Use null if confidence < 0.5\n- confidence should reflect the quality of available evidence",
      "cost_info": {
        "char_count": 400,
        "token_count": 120,
        "note": "Vendor专属识别提示词-noRAG版，无知识增强"
      }
    },
    {
      "id": "os",
      "name": "OS专属识别版",
      "description": "专门针对操作系统(OS)识别任务优化，只输出os字段，强调版本号提取",
      "system_prompt": "Identify device OPERATING SYSTEM from network scan data.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"os\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== OS PATTERNS ===\n- \"MikroTik X.XX.XX\" → \"RouterOS X.XX.XX\"\n- \"JUNOS\", \"Version X.X\" → \"JunOS X.X\"\n- \"Version 6.00LS\" (FTP banner) → highly probably \"JUNOS\"\n- \"Cisco IOS\" → \"Cisco IOS\" + version\n- \"FortiOS\" → \"FortiOS\" + version\n- \"KeeneticOS\" → \"KeeneticOS\" + version\n- \"EdgeOS\" → \"EdgeOS\" + version\n- \"VRP\" → \"Huawei VRP\" + version\n- \"UNIVERGE IX\" → \"IX Series\" + version\n\n=== ⚠️ MUST INCLUDE VERSION ===\n❌ \"RouterOS\" → WRONG (no version)\n✓ \"RouterOS 7.16.1\" → CORRECT\n❌ \"JunOS\" → WRONG\n✓ \"JunOS 21.4R1\" → CORRECT\n\n=== OS vs VENDOR ===\n- \"MikroTik\" is VENDOR, \"RouterOS\" is OS\n- \"Cisco\" is VENDOR, \"IOS\" is OS\n- \"Juniper\" is VENDOR, \"JunOS\" is OS\n\n=== RULES ===\n- os = OS name + version when available\n- Extract version from FTP/SSH/HTTP banners\n- Use null if confidence < 0.5",
      "cost_info": {
        "char_count": 900,
        "token_count": 310,
        "note": "OS专属识别提示词-精简版"
      }
    },
    {
      "id": "devicetype",
      "name": "Device Type专属识别版",
      "description": "专门针对设备类型(Device Type)识别任务优化，只输出type字段",
      "system_prompt": "Identify device TYPE from network scan data.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"type\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== ALLOWED TYPES (USE ONLY THESE) ===\nrouter | switch | firewall | server | camera | nas | printer | iot | appliance\n\n=== OS/VENDOR → TYPE ===\n- RouterOS/MikroTik → router\n- JunOS/Juniper → router\n- Cisco IOS → router\n- FortiOS/FortiGate → firewall\n- PAN-OS/Palo Alto → firewall\n- SonicOS → firewall\n- Synology DSM → nas\n- QNAP QTS → nas\n\n=== ⚠️ TYPE STANDARDIZATION ===\n- management_interface → router\n- gateway → router\n- access_point/ap → router\n- broadband_router → router\n- network_device → router\n- web_interface → server\n- load_balancer → router\n\n=== COMMON MISTAKES ===\n❌ type: \"RouterOS\" (this is OS)\n❌ type: \"MikroTik\" (this is vendor)\n❌ type: \"management_interface\"\n✓ type: \"router\"\n\n=== RULES ===\n- type must be from allowed list\n- Infer from OS/vendor when explicit type unavailable\n- Use null if confidence < 0.5",
      "cost_info": {
        "char_count": 950,
        "token_count": 320,
        "note": "Device Type专属识别提示词-精简版"
      }
    },
    {
      "id": "merge",
      "name": "Merge三标签联合识别版(RAG)",
      "description": "同时识别vendor、os、devicetype三个标签，包含知识增强",
      "system_prompt": "Identify device VENDOR, OS, and TYPE from network scan data.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"vendor\": str|null, \"os\": str|null, \"type\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== HIGH CONFIDENCE SIGNATURES (极大概率) ===\n- SSH-*-Cisco-* → Cisco\n- cisco-IOS (HTTP) → Cisco\n- User Access Verification (Telnet) → Cisco\n- SSH-2.0-ROSSSH → MikroTik\n- MikroTik, RouterOS → MikroTik\n- SSH-2.0-HUAWEI-* → Huawei\n- Stelnet warning, VRP → Huawei\n- 220 FTP service ready. → Huawei\n- HTTPD (HTTP Server) → H3C\n- SSH-*-Comware-* → H3C\n- SSH-*-RGOS_* → Ruijie\n- Version 6.00LS (FTP) → Juniper\n- SSH-2.0-OpenSSH_7.5 → Juniper\n- SSH-2.0-OpenSSH_6.9 → Juniper\n- Embedthis-Appweb/3.2.3 → Juniper\n- JUNOS → Juniper\n- FortiGate, FortiOS → Fortinet\n- UBNT, UniFi, EdgeOS → Ubiquiti\n- ZyXEL, ZyNOS → ZyXEL\n- UNIVERGE, IX Series → NEC\n- Yamaha, RTX → Yamaha\n- Server: uc-httpd → Xiongmai\n- Server: H264DVR → H264DVR\n- TVT RTSP Server, Cross Web Server, DVR Components Download → TVT\n- Hello, this is Quagga → Quagga\n- Server: kong/ → Opensource (Kong API Gateway)\n\n=== MEDIUM CONFIDENCE (需结合其他证据) ===\n- nginx (HTTP) → Cisco (combine with other evidence)\n- SSH-*-OpenSSH_*p1 Debian-* → Linux/net-snmp (combine with other evidence)\n\n=== OS PATTERNS (MUST INCLUDE VERSION) ===\n- MikroTik X.XX.XX → RouterOS X.XX.XX\n- JUNOS, Version X.X → JunOS X.X\n- Cisco IOS → Cisco IOS + version\n- FortiOS → FortiOS + version\n- VRP → Huawei VRP + version\n- UNIVERGE IX → IX Series + version\n\n=== DEVICE TYPES (USE ONLY THESE) ===\nrouter | switch | firewall | server | camera | nas | printer | iot | appliance\n\n=== TYPE INFERENCE ===\n- RouterOS/MikroTik → router\n- JunOS/Juniper → router\n- Cisco IOS → router\n- FortiOS/FortiGate → firewall\n- Synology DSM → nas\n- QNAP QTS → nas\n- Xiongmai/H264DVR/TVT → camera\n\n=== TYPE STANDARDIZATION ===\n- management_interface/gateway/access_point/broadband_router/network_device → router\n- web_interface → server\n\n=== RULES ===\n- vendor = manufacturer name (NOT OS)\n- os = OS name + version when available\n- type = from allowed list only\n- Use null if confidence < 0.5",
      "cost_info": {
        "char_count": 1700,
        "token_count": 560,
        "note": "Merge版-RAG版，包含知识增强"
      }
    },
    {
      "id": "merge_norag",
      "name": "Merge三标签联合识别版(noRAG)",
      "description": "同时识别vendor、os、devicetype三个标签，不包含知识增强",
      "system_prompt": "Identify device VENDOR, OS, and TYPE from network scan data.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"vendor\": str|null, \"os\": str|null, \"type\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== FIELD DEFINITIONS ===\n- vendor: Device manufacturer name (e.g., \"Cisco\", \"MikroTik\")\n- os: Operating system with version if available (e.g., \"RouterOS 6.49.10\")\n- type: Device type - one of: router | switch | firewall | server | camera | nas | printer | iot | appliance\n\n=== RULES ===\n- vendor = manufacturer name (NOT OS name)\n- os = OS name + version when available\n- type = from allowed list only\n- Use null if confidence < 0.5\n- confidence should reflect the quality of available evidence",
      "cost_info": {
        "char_count": 700,
        "token_count": 200,
        "note": "Merge版-noRAG版，无知识增强"
      }
    },
    {
      "id": "raw",
      "name": "Raw基础版-无知识增强",
      "description": "仅包含任务解释、输出规则和字段解释，不包含额外知识和规范化处理，用于对比实验",
      "system_prompt": "Identify device VENDOR, OS, and TYPE from network scan data.\n\n=== OUTPUT REQUIREMENTS ===\n1. Return ONLY a valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain the EXACT \"ip\" field from input.\n3. The number of results MUST equal the number of input records.\n\nFormat: [{\"ip\": \"exact_ip\", \"vendor\": str|null, \"os\": str|null, \"type\": str|null, \"confidence\": 0-1, \"evidence\": [{\"src\": str, \"val\": str}]}]\n\n=== FIELD DEFINITIONS ===\n- ip: The exact IP address from input (required)\n- vendor: Device manufacturer name (e.g., \"Cisco\", \"MikroTik\")\n- os: Operating system with version if available (e.g., \"RouterOS 6.49.10\")\n- type: Device type - one of: router | switch | firewall | server | camera | nas | printer | iot | appliance\n- confidence: Overall confidence score from 0 to 1\n- evidence: Array of evidence objects with source field name and value\n\n=== RULES ===\n- Analyze the input data fields to identify device information\n- Use null for fields that cannot be determined\n- confidence should reflect the quality of available evidence",
      "cost_info": {
        "char_count": 1050,
        "token_count": 280,
        "note": "Raw基础版-无知识增强，用于对比实验"
      }
    }
  ]
}