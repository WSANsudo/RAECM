{
  "prompts": [
    {
      "id": "default",
      "name": "默认提示词",
      "description": "程序内置的默认提示词，不在此文件中定义",
      "system_prompt": null,
      "cost_info": {
        "char_count": 1606,
        "token_count": 471,
        "record_count": 1821,
        "avg_input_tokens": 144.1,
        "avg_output_tokens": 138.8,
        "total_cost": {
          "deepseek-v3.2": 1.1127,
          "gemini-2.5-flash-lite-preview-06-17": 0.6236,
          "gpt-5-nano-ca": 0.5139,
          "gemini-2.5-flash": 3.8665,
          "grok-4-fast": 0.944,
          "gpt-4.1-nano": 1.0913,
          "gpt-4o-mini": 1.6369,
          "gpt-4o-mini-ca": 1.1692,
          "gpt-5-mini": 4.497,
          "claude-3-5-haiku-20241022": 9.0583,
          "qwen3-235b-a22b": 2.1826,
          "kimi-k2-0711-preview": 4.3651,
          "gpt-4o": 27.2821,
          "gpt-5": 22.4849,
          "gemini-2.5-pro": 13.945,
          "claude-3-5-sonnet-20241022": 27.1749,
          "grok-4": 21.7399,
          "deepseek-r1": 3.7415
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.6111,
          "gemini-2.5-flash-lite-preview-06-17": 0.3424,
          "gpt-5-nano-ca": 0.2822,
          "gemini-2.5-flash": 2.1233,
          "grok-4-fast": 0.5184,
          "gpt-4.1-nano": 0.5993,
          "gpt-4o-mini": 0.8989,
          "gpt-4o-mini-ca": 0.6421,
          "gpt-5-mini": 2.4695,
          "claude-3-5-haiku-20241022": 4.9744,
          "qwen3-235b-a22b": 1.1986,
          "kimi-k2-0711-preview": 2.3971,
          "gpt-4o": 14.9819,
          "gpt-5": 12.3476,
          "gemini-2.5-pro": 7.6579,
          "claude-3-5-sonnet-20241022": 14.923,
          "grok-4": 11.9384,
          "deepseek-r1": 2.0547
        },
        "note": "程序内置默认提示词"
      }
    },
    {
      "id": "c1",
      "name": "精简版-快速校验",
      "description": "精简提示词，快速校验结果合理性，约450字符",
      "system_prompt": "Validate network asset identification results.\n\n⚠️ CRITICAL: Return ONLY valid JSON array. Each result MUST contain the EXACT \"ip\" from input - DO NOT modify or omit any IP.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"validation_status\": \"verified|adjusted|rejected\", \"evidence_quality\": \"strong|moderate|weak|insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\nRULES:\n- Return exactly the same number of results as input records\n- IP addresses must be copied EXACTLY as provided\n- verified: result is correct, adjustments={}\n- adjusted: fix errors in adjustments field\n- rejected: set confidence<0.3, clear invalid fields\n- Ensure os/firmware include versions\n- model must be hardware SKU, not OS name",
      "cost_info": {
        "char_count": 539,
        "token_count": 136,
        "record_count": 1821,
        "avg_input_tokens": 144.1,
        "avg_output_tokens": 138.8,
        "total_cost": {
          "deepseek-v3.2": 0.8687,
          "gemini-2.5-flash-lite-preview-06-17": 0.5423,
          "gpt-5-nano-ca": 0.4733,
          "gemini-2.5-flash": 3.7445,
          "grok-4-fast": 0.7813,
          "gpt-4.1-nano": 0.9489,
          "gpt-4o-mini": 1.4234,
          "gpt-4o-mini-ca": 1.0167,
          "gpt-5-mini": 4.1411,
          "claude-3-5-haiku-20241022": 8.0416,
          "qwen3-235b-a22b": 1.8979,
          "kimi-k2-0711-preview": 3.7958,
          "gpt-4o": 23.7235,
          "gpt-5": 20.7056,
          "gemini-2.5-pro": 12.5216,
          "claude-3-5-sonnet-20241022": 24.1247,
          "grok-4": 19.2998,
          "deepseek-r1": 3.2535
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.4771,
          "gemini-2.5-flash-lite-preview-06-17": 0.2978,
          "gpt-5-nano-ca": 0.2599,
          "gemini-2.5-flash": 2.0563,
          "grok-4-fast": 0.429,
          "gpt-4.1-nano": 0.5211,
          "gpt-4o-mini": 0.7817,
          "gpt-4o-mini-ca": 0.5583,
          "gpt-5-mini": 2.2741,
          "claude-3-5-haiku-20241022": 4.416,
          "qwen3-235b-a22b": 1.0422,
          "kimi-k2-0711-preview": 2.0844,
          "gpt-4o": 13.0278,
          "gpt-5": 11.3705,
          "gemini-2.5-pro": 6.8762,
          "claude-3-5-sonnet-20241022": 13.248,
          "grok-4": 10.5984,
          "deepseek-r1": 1.7867
        }
      }
    },
    {
      "id": "c2",
      "name": "详细版-深度校验",
      "description": "详细提示词，深度校验并修正结果，约750字符",
      "system_prompt": "Validate and correct network asset identification results.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain the EXACT \"ip\" from input - DO NOT modify, truncate, or omit any IP.\n3. Return exactly the same number of results as input records.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"validation_status\": \"verified|adjusted|rejected\", \"evidence_quality\": \"strong|moderate|weak|insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\n=== VALIDATION CHECKS ===\n1. Field format: os/firmware must include version\n2. Field semantics: model=hardware SKU, not OS/firmware\n3. Consistency: vendor matches model series\n4. Evidence support: confidence matches evidence quality\n\n=== ADJUSTMENT RULES ===\n- verified: no issues, adjustments={}\n- adjusted: provide corrections in adjustments\n- rejected: set {\"confidence\": <0.3, \"vendor\": null, \"model\": null}\n\n=== COMMON ISSUES ===\n- \"RouterOS\" as model → move to os field\n- Missing version in os/firmware",
      "cost_info": {
        "char_count": 865,
        "token_count": 219,
        "record_count": 1821,
        "avg_input_tokens": 144.1,
        "avg_output_tokens": 138.8,
        "total_cost": {
          "deepseek-v3.2": 0.9292,
          "gemini-2.5-flash-lite-preview-06-17": 0.5624,
          "gpt-5-nano-ca": 0.4833,
          "gemini-2.5-flash": 3.7747,
          "grok-4-fast": 0.8216,
          "gpt-4.1-nano": 0.9842,
          "gpt-4o-mini": 1.4763,
          "gpt-4o-mini-ca": 1.0545,
          "gpt-5-mini": 4.2293,
          "claude-3-5-haiku-20241022": 8.2935,
          "qwen3-235b-a22b": 1.9684,
          "kimi-k2-0711-preview": 3.9368,
          "gpt-4o": 24.6052,
          "gpt-5": 21.1465,
          "gemini-2.5-pro": 12.8743,
          "claude-3-5-sonnet-20241022": 24.8804,
          "grok-4": 19.9043,
          "deepseek-r1": 3.3744
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.5103,
          "gemini-2.5-flash-lite-preview-06-17": 0.3088,
          "gpt-5-nano-ca": 0.2654,
          "gemini-2.5-flash": 2.0729,
          "grok-4-fast": 0.4512,
          "gpt-4.1-nano": 0.5405,
          "gpt-4o-mini": 0.8107,
          "gpt-4o-mini-ca": 0.5791,
          "gpt-5-mini": 2.3225,
          "claude-3-5-haiku-20241022": 4.5544,
          "qwen3-235b-a22b": 1.081,
          "kimi-k2-0711-preview": 2.1619,
          "gpt-4o": 13.5119,
          "gpt-5": 11.6126,
          "gemini-2.5-pro": 7.0699,
          "claude-3-5-sonnet-20241022": 13.6631,
          "grok-4": 10.9304,
          "deepseek-r1": 1.8531
        }
      }
    },
    {
      "id": "c3",
      "name": "严格版-高标准校验",
      "description": "严格校验，对证据质量要求更高，约650字符",
      "system_prompt": "Strictly validate network asset identification results.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain the EXACT \"ip\" from input - DO NOT modify or omit any IP.\n3. Return exactly the same number of results as input records.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"validation_status\": \"verified|adjusted|rejected\", \"evidence_quality\": \"strong|moderate|weak|insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\n=== STRICT CRITERIA ===\n- \"strong\" evidence: explicit banner/version string\n- \"moderate\": inferred from multiple signals\n- \"weak\": single indirect signal\n- \"insufficient\": no supporting evidence\n\n=== VALIDATION ===\n- Reject if confidence>0.7 but evidence<moderate\n- Reject if model is OS/firmware name\n- Adjust confidence to match evidence quality\n\n=== ADJUSTMENTS ===\n- verified: adjustments={}\n- adjusted: {\"field\": \"corrected_value\"}\n- rejected: {\"confidence\": <0.3, \"vendor\": null, \"model\": null}",
      "cost_info": {
        "char_count": 819,
        "token_count": 210,
        "record_count": 1821,
        "avg_input_tokens": 144.1,
        "avg_output_tokens": 138.8,
        "total_cost": {
          "deepseek-v3.2": 0.9226,
          "gemini-2.5-flash-lite-preview-06-17": 0.5602,
          "gpt-5-nano-ca": 0.4823,
          "gemini-2.5-flash": 3.7714,
          "grok-4-fast": 0.8172,
          "gpt-4.1-nano": 0.9804,
          "gpt-4o-mini": 1.4706,
          "gpt-4o-mini-ca": 1.0504,
          "gpt-5-mini": 4.2197,
          "claude-3-5-haiku-20241022": 8.2662,
          "qwen3-235b-a22b": 1.9608,
          "kimi-k2-0711-preview": 3.9215,
          "gpt-4o": 24.5096,
          "gpt-5": 21.0987,
          "gemini-2.5-pro": 12.836,
          "claude-3-5-sonnet-20241022": 24.7985,
          "grok-4": 19.8388,
          "deepseek-r1": 3.3613
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.5067,
          "gemini-2.5-flash-lite-preview-06-17": 0.3076,
          "gpt-5-nano-ca": 0.2648,
          "gemini-2.5-flash": 2.0711,
          "grok-4-fast": 0.4488,
          "gpt-4.1-nano": 0.5384,
          "gpt-4o-mini": 0.8076,
          "gpt-4o-mini-ca": 0.5768,
          "gpt-5-mini": 2.3173,
          "claude-3-5-haiku-20241022": 4.5393,
          "qwen3-235b-a22b": 1.0768,
          "kimi-k2-0711-preview": 2.1535,
          "gpt-4o": 13.4594,
          "gpt-5": 11.5863,
          "gemini-2.5-pro": 7.0489,
          "claude-3-5-sonnet-20241022": 13.6181,
          "grok-4": 10.8944,
          "deepseek-r1": 1.8459
        }
      }
    },
    {
      "id": "c4",
      "name": "结构约束+负面示例版",
      "description": "方案三+方案五组合：严格字段定义+常见错误约束，推荐使用",
      "system_prompt": "Validate and correct network asset identification results.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY a valid JSON array. NO markdown code blocks, NO explanations, NO extra text.\n2. Each result MUST contain the EXACT \"ip\" field from input - DO NOT modify, truncate, or omit any IP address.\n3. The number of results MUST equal the number of input records.\n4. IP addresses must be copied EXACTLY as provided.\n\nFormat: [{\"ip\": \"exact_ip_from_input\", \"validation_status\": \"verified\"|\"adjusted\"|\"rejected\", \"evidence_quality\": \"strong\"|\"moderate\"|\"weak\"|\"insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\n=== STRICT FIELD DEFINITIONS ===\nvalidation_status:\n  - \"verified\": Result is correct, no changes needed, adjustments={}\n  - \"adjusted\": Errors found and corrected, corrections in adjustments field\n  - \"rejected\": Evidence insufficient, set low confidence and clear invalid fields\n\nevidence_quality:\n  - \"strong\": Explicit version/model in banner (e.g., \"MikroTik 6.49.15\")\n  - \"moderate\": Multiple indirect signals supporting conclusion\n  - \"weak\": Single indirect signal\n  - \"insufficient\": No supporting evidence for claimed identification\n\nadjustments: {} for verified, {\"field\": \"corrected_value\"} for adjusted/rejected\n\n=== VALIDATION CHECKS ===\n1. model field must be hardware SKU, NOT OS/firmware name\n2. os field must include version when available\n3. vendor must match model series (e.g., RB5009 → MikroTik)\n4. confidence must match evidence_quality (strong→0.9+, moderate→0.7-0.9, weak→0.5-0.7)\n\n=== COMMON MISTAKES TO CORRECT ===\n❌ model: \"RouterOS\" → adjustments: {\"model\": null, \"os\": \"RouterOS X.X.X\"}\n❌ model: \"MikroTik 6.49.15\" → adjustments: {\"model\": null, \"firmware\": \"MikroTik 6.49.15\"}\n❌ os: \"RouterOS\" (no version) → adjustments: {\"os\": \"RouterOS X.X.X\"} or keep if version unknown\n❌ confidence: 0.95 with weak evidence → adjustments: {\"confidence\": 0.6}\n\n=== REJECTION CRITERIA ===\nReject (set validation_status=\"rejected\") when:\n- confidence > 0.7 but evidence_quality is \"weak\" or \"insufficient\"\n- No evidence supports the vendor/model claim\n- Critical field errors that cannot be corrected",
      "cost_info": {
        "char_count": 1859,
        "token_count": 505,
        "record_count": 1821,
        "avg_input_tokens": 144.1,
        "avg_output_tokens": 138.8,
        "total_cost": {
          "deepseek-v3.2": 1.1375,
          "gemini-2.5-flash-lite-preview-06-17": 0.6318,
          "gpt-5-nano-ca": 0.5181,
          "gemini-2.5-flash": 3.8789,
          "grok-4-fast": 0.9605,
          "gpt-4.1-nano": 1.1057,
          "gpt-4o-mini": 1.6586,
          "gpt-4o-mini-ca": 1.1847,
          "gpt-5-mini": 4.5331,
          "claude-3-5-haiku-20241022": 9.1615,
          "qwen3-235b-a22b": 2.2115,
          "kimi-k2-0711-preview": 4.4229,
          "gpt-4o": 27.6433,
          "gpt-5": 22.6655,
          "gemini-2.5-pro": 14.0895,
          "claude-3-5-sonnet-20241022": 27.4844,
          "grok-4": 21.9876,
          "deepseek-r1": 3.7911
        },
        "cost_per_1k_records": {
          "deepseek-v3.2": 0.6247,
          "gemini-2.5-flash-lite-preview-06-17": 0.347,
          "gpt-5-nano-ca": 0.2845,
          "gemini-2.5-flash": 2.1301,
          "grok-4-fast": 0.5274,
          "gpt-4.1-nano": 0.6072,
          "gpt-4o-mini": 0.9108,
          "gpt-4o-mini-ca": 0.6506,
          "gpt-5-mini": 2.4893,
          "claude-3-5-haiku-20241022": 5.031,
          "qwen3-235b-a22b": 1.2144,
          "kimi-k2-0711-preview": 2.4288,
          "gpt-4o": 15.1803,
          "gpt-5": 12.4467,
          "gemini-2.5-pro": 7.7372,
          "claude-3-5-sonnet-20241022": 15.093,
          "grok-4": 12.0744,
          "deepseek-r1": 2.0819
        }
      }
    },
    {
      "id": "vendor",
      "name": "Vendor校验专属版(RAG)",
      "description": "专门针对厂商(Vendor)校验任务优化，包含知识增强，只校验vendor字段",
      "system_prompt": "Validate VENDOR identification results.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"original_confidence\": float, \"validated_confidence\": float, \"issues_found\": [], \"adjustments\": {}}]\n\n=== HIGH CONFIDENCE EVIDENCE (极大概率, valid) ===\n- SSH-*-Cisco-*, cisco-IOS, User Access Verification → Cisco\n- SSH-2.0-ROSSSH, MikroTik, RouterOS → MikroTik\n- SSH-2.0-HUAWEI-*, Stelnet warning, VRP, 220 FTP service ready. → Huawei\n- HTTPD, SSH-*-Comware-* → H3C\n- SSH-*-RGOS_* → Ruijie\n- Version 6.00LS, SSH-2.0-OpenSSH_7.5/6.9, Embedthis-Appweb/3.2.3, JUNOS → Juniper\n- FortiGate, FortiOS → Fortinet\n- Server: uc-httpd → Xiongmai\n- Server: H264DVR → H264DVR\n- TVT RTSP Server, Cross Web Server, DVR Components Download → TVT\n- Hello, this is Quagga → Quagga\n- Server: kong/ → Opensource (Kong API Gateway)\n\n=== MEDIUM CONFIDENCE (需结合其他证据) ===\n- nginx (HTTP) → Cisco (need other evidence)\n- SSH-*-OpenSSH_*p1 Debian-* → Linux/net-snmp (need other evidence)\n\n=== VENDOR VALIDATION RULES ===\n1. vendor must be manufacturer name, NOT OS name\n2. Check vendor-OS consistency\n\n=== COMMON MISTAKES TO CORRECT ===\n❌ vendor: RouterOS → MikroTik\n❌ vendor: JunOS → Juniper\n❌ vendor: FortiOS → Fortinet\n❌ vendor: IOS → Cisco\n\n=== VENDOR NORMALIZATION ===\n- Juniper Networks, Inc. → Juniper\n- ciscoSystems → Cisco\n- HUAWEI Technology → Huawei\n\n=== STATUS RULES ===\n- verified: vendor is correct manufacturer name\n- adjusted: vendor was OS name or needs normalization\n- rejected: no evidence supports vendor claim",
      "cost_info": {
        "char_count": 1150,
        "token_count": 380,
        "note": "Vendor校验专属提示词-RAG版"
      }
    },
    {
      "id": "vendor_norag",
      "name": "Vendor校验专属版(noRAG)",
      "description": "专门针对厂商(Vendor)校验任务优化，不包含知识增强，只校验vendor字段",
      "system_prompt": "Validate VENDOR identification results.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"original_confidence\": float, \"validated_confidence\": float, \"issues_found\": [], \"adjustments\": {}}]\n\n=== VENDOR VALIDATION RULES ===\n1. vendor must be manufacturer name, NOT OS name\n2. Check vendor-OS consistency\n\n=== STATUS RULES ===\n- verified: vendor is correct manufacturer name\n- adjusted: vendor was OS name or needs correction\n- rejected: no evidence supports vendor claim",
      "cost_info": {
        "char_count": 550,
        "token_count": 150,
        "note": "Vendor校验专属提示词-noRAG版，无知识增强"
      }
    },
    {
      "id": "os",
      "name": "OS校验专属版",
      "description": "专门针对操作系统(OS)校验任务优化，只校验os字段，强调版本号",
      "system_prompt": "Validate OS identification results.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"original_confidence\": float, \"validated_confidence\": float, \"issues_found\": [], \"adjustments\": {}}]\n\n=== OS VALIDATION RULES ===\n1. os must be OS name, NOT vendor name\n2. os SHOULD include version when available\n3. Check if version can be extracted from evidence\n4. \"Version 6.00LS\" in FTP banner → highly probably JUNOS (valid evidence)\n\n=== COMMON MISTAKES TO CORRECT ===\n❌ os: \"MikroTik\" → adjustments: {\"os\": \"RouterOS\"} (MikroTik is vendor)\n❌ os: \"Juniper\" → adjustments: {\"os\": \"JunOS\"} (Juniper is vendor)\n❌ os: \"Cisco\" → adjustments: {\"os\": \"Cisco IOS\"} (Cisco is vendor)\n❌ os: \"RouterOS\" (no version) → Check evidence for version, add if found\n\n=== OS vs VENDOR ===\n- MikroTik → RouterOS\n- Juniper → JunOS\n- Cisco → IOS/IOS-XE/NX-OS\n- Fortinet → FortiOS\n- Keenetic → KeeneticOS\n\n=== STATUS RULES ===\n- verified: os is correct OS name (with version if available)\n- adjusted: os was vendor name or missing version\n- rejected: no evidence supports os claim",
      "cost_info": {
        "char_count": 900,
        "token_count": 300,
        "note": "OS校验专属提示词"
      }
    },
    {
      "id": "devicetype",
      "name": "Device Type校验专属版",
      "description": "专门针对设备类型(Device Type)校验任务优化，只校验type字段",
      "system_prompt": "Validate DEVICE TYPE identification results.\n\nCRITICAL: Return ONLY valid JSON array. Each result MUST contain EXACT \"ip\" from input.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"original_confidence\": float, \"validated_confidence\": float, \"issues_found\": [], \"adjustments\": {}}]\n\n=== ALLOWED TYPES ===\nrouter | switch | firewall | server | camera | nas | printer | iot | appliance\n\n=== TYPE VALIDATION RULES ===\n1. type must be from allowed list\n2. type must be consistent with OS/vendor\n3. Non-standard types must be mapped\n\n=== TYPE STANDARDIZATION ===\n- management_interface → router\n- gateway → router\n- access_point/ap → router\n- broadband_router → router\n- network_device → router\n- web_interface → server\n- load_balancer → router\n\n=== OS/VENDOR → TYPE CONSISTENCY ===\n- RouterOS/MikroTik → router\n- JunOS/Juniper → router\n- FortiOS/Fortinet → firewall\n- Synology DSM → nas\n- QNAP QTS → nas\n\n=== COMMON MISTAKES TO CORRECT ===\n❌ type: \"RouterOS\" → adjustments: {\"type\": \"router\"}\n❌ type: \"MikroTik\" → adjustments: {\"type\": \"router\"}\n❌ type: \"management_interface\" → adjustments: {\"type\": \"router\"}\n❌ type: \"server\" when os is RouterOS → adjustments: {\"type\": \"router\"}\n\n=== STATUS RULES ===\n- verified: type is from allowed list and consistent\n- adjusted: type was non-standard or inconsistent\n- rejected: no evidence supports type claim",
      "cost_info": {
        "char_count": 1100,
        "token_count": 350,
        "note": "Device Type校验专属提示词"
      }
    },
    {
      "id": "merge",
      "name": "Merge三标签联合校验版(RAG)",
      "description": "同时校验vendor、os、devicetype三个标签，包含知识增强",
      "system_prompt": "Validate VENDOR, OS, and TYPE identification results.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain EXACT \"ip\" from input - DO NOT modify or omit any IP.\n3. Return exactly the same number of results as input records.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"evidence_quality\": \"strong|moderate|weak|insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\n=== HIGH CONFIDENCE EVIDENCE (极大概率, valid) ===\n- SSH-*-Cisco-*, cisco-IOS, User Access Verification → Cisco\n- SSH-2.0-ROSSSH, MikroTik, RouterOS → MikroTik\n- SSH-2.0-HUAWEI-*, Stelnet warning, VRP, 220 FTP service ready. → Huawei\n- HTTPD, SSH-*-Comware-* → H3C\n- SSH-*-RGOS_* → Ruijie\n- Version 6.00LS, SSH-2.0-OpenSSH_7.5/6.9, Embedthis-Appweb/3.2.3, JUNOS → Juniper\n- FortiGate, FortiOS → Fortinet\n- Server: uc-httpd → Xiongmai\n- Server: H264DVR → H264DVR\n- TVT RTSP Server, Cross Web Server, DVR Components Download → TVT\n- Hello, this is Quagga → Quagga\n- Server: kong/ → Opensource (Kong API Gateway)\n\n=== MEDIUM CONFIDENCE (需结合其他证据) ===\n- nginx (HTTP) → Cisco (need other evidence)\n- SSH-*-OpenSSH_*p1 Debian-* → Linux/net-snmp (need other evidence)\n\n=== VENDOR VALIDATION ===\n- vendor must be manufacturer name, NOT OS name\n- RouterOS → MikroTik, JunOS → Juniper, FortiOS → Fortinet, IOS → Cisco\n- Normalize: Juniper Networks, Inc. → Juniper, ciscoSystems → Cisco\n\n=== OS VALIDATION ===\n- os must be OS name, NOT vendor name\n- os SHOULD include version when available\n- MikroTik → RouterOS, Juniper → JunOS, Cisco → IOS\n\n=== TYPE VALIDATION ===\n- type must be from: router|switch|firewall|server|camera|nas|printer|iot|appliance\n- Standardize: management_interface/gateway/access_point/broadband_router/network_device → router\n- Check consistency: RouterOS/MikroTik → router, FortiOS → firewall, Synology DSM → nas\n- Xiongmai/H264DVR/TVT → camera\n\n=== EVIDENCE QUALITY ===\n- strong: explicit banner/version\n- moderate: multiple indirect signals\n- weak: single indirect signal\n- insufficient: no supporting evidence\n\n=== STATUS RULES ===\n- verified: all fields correct, adjustments={}\n- adjusted: errors corrected, {\"field\": \"corrected_value\"}\n- rejected: insufficient evidence, {\"confidence\": <0.3, \"vendor\": null, \"os\": null, \"type\": null}",
      "cost_info": {
        "char_count": 1900,
        "token_count": 610,
        "note": "Merge版-RAG版，包含知识增强"
      }
    },
    {
      "id": "merge_norag",
      "name": "Merge三标签联合校验版(noRAG)",
      "description": "同时校验vendor、os、devicetype三个标签，不包含知识增强",
      "system_prompt": "Validate VENDOR, OS, and TYPE identification results.\n\n=== ⚠️ CRITICAL OUTPUT REQUIREMENTS ⚠️ ===\n1. Return ONLY valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain EXACT \"ip\" from input - DO NOT modify or omit any IP.\n3. Return exactly the same number of results as input records.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"evidence_quality\": \"strong|moderate|weak|insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\n=== FIELD VALIDATION ===\n- vendor: must be manufacturer name, NOT OS name\n- os: must be OS name, NOT vendor name; SHOULD include version when available\n- type: must be from: router|switch|firewall|server|camera|nas|printer|iot|appliance\n\n=== EVIDENCE QUALITY ===\n- strong: explicit banner/version\n- moderate: multiple indirect signals\n- weak: single indirect signal\n- insufficient: no supporting evidence\n\n=== STATUS RULES ===\n- verified: all fields correct, adjustments={}\n- adjusted: errors corrected, {\"field\": \"corrected_value\"}\n- rejected: insufficient evidence, {\"confidence\": <0.3, \"vendor\": null, \"os\": null, \"type\": null}",
      "cost_info": {
        "char_count": 1000,
        "token_count": 300,
        "note": "Merge版-noRAG版，无知识增强"
      }
    },
    {
      "id": "raw",
      "name": "Raw基础版-无知识增强",
      "description": "仅包含任务解释、输出规则和字段解释，不包含额外知识和规范化处理，用于对比实验",
      "system_prompt": "Validate network asset identification results.\n\n=== OUTPUT REQUIREMENTS ===\n1. Return ONLY a valid JSON array. NO markdown, NO explanations.\n2. Each result MUST contain the EXACT \"ip\" field from input.\n3. The number of results MUST equal the number of input records.\n\nFormat: [{\"ip\": \"exact_ip\", \"validation_status\": \"verified|adjusted|rejected\", \"evidence_quality\": \"strong|moderate|weak|insufficient\", \"issues_found\": [], \"original_confidence\": float, \"validated_confidence\": float, \"reasoning\": null, \"adjustments\": {}}]\n\n=== FIELD DEFINITIONS ===\n- ip: The exact IP address from input (required)\n- validation_status: \"verified\" if correct, \"adjusted\" if corrected, \"rejected\" if invalid\n- evidence_quality: \"strong\", \"moderate\", \"weak\", or \"insufficient\"\n- issues_found: Array of issue descriptions found during validation\n- original_confidence: The confidence score from input\n- validated_confidence: The adjusted confidence score after validation\n- reasoning: Optional reasoning for the validation decision\n- adjustments: Object containing field corrections (empty {} if no changes)\n\n=== RULES ===\n- Validate that identification results are supported by evidence\n- Check field consistency and format correctness\n- Use null for fields that cannot be determined",
      "cost_info": {
        "char_count": 1150,
        "token_count": 300,
        "note": "Raw基础版-无知识增强，用于对比实验"
      }
    }
  ]
}